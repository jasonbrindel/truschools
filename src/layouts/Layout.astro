---
import '@/styles/global.css';
import logoUp from '@/images/logo-truschools-up.png';
import logoOver from '@/images/logo-truschools-over.png';
import logoWhiteUp from '@/images/logo-truschools-white-up.png';
import logoWhiteOver from '@/images/logo-truschools-white-over.png';

interface Props {
  title: string;
  description?: string;
  ogImage?: string;
  noIndex?: boolean;
}

const {
  title,
  description = "TruSchools provides comprehensive information on every college, university and K-12 school in the United States.",
  ogImage = "/og-image.svg",
  noIndex = false
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const fullOgImage = new URL(ogImage, Astro.site);
const currentYear = new Date().getFullYear();

// Navigation items matching original site structure
const mainNav = [
  { label: 'K-12 Schools', href: '/schools' },
  { label: 'Colleges & Universities', href: '/colleges' },
  { label: 'Vocational Schools', href: '/vocational-schools' },
];

// Vocational schools dropdown items
const vocationalDropdown = [
  { label: 'All Vocational Schools', href: '/vocational-schools' },
  { label: 'Beauty Schools', href: '/beauty-schools' },
  { label: 'Trade Schools', href: '/trade-schools' },
  { label: 'Healthcare Schools', href: '/healthcare-schools' },
  { label: 'Technology Schools', href: '/technology-schools' },
  { label: 'Culinary Schools', href: '/culinary-schools' },
];

// Resources dropdown items
const resourcesDropdown = [
  { label: 'Free Classes', href: '/classes' },
  { label: 'Financial Aid', href: '/financial-aid' },
  { label: 'Degrees', href: '/degrees' },
];
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content={description} />
  {noIndex && <meta name="robots" content="noindex, nofollow" />}
  <title>{title} | TruSchools</title>

  <!-- Canonical -->
  <link rel="canonical" href={canonicalURL} />

  <!-- Open Graph -->
  <meta property="og:title" content={`${title} | TruSchools`} />
  <meta property="og:description" content={description} />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="TruSchools" />
  <meta property="og:url" content={canonicalURL} />
  <meta property="og:image" content={fullOgImage} />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content={`${title} | TruSchools`} />
  <meta name="twitter:description" content={description} />
  <meta name="twitter:image" content={fullOgImage} />

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico?v=2" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=2" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?v=2" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <meta name="theme-color" content="#0d83dd" />
</head>
<body class="min-h-screen flex flex-col">
  <!-- Skip to content link -->
  <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-brand-blue text-white px-4 py-2 rounded z-50">
    Skip to content
  </a>

  <!-- Header with Logo and Search -->
  <header class="bg-white">
    <div class="container py-4">
      <div class="flex flex-col lg:flex-row lg:items-end gap-4 lg:gap-5">
        <!-- Logo - matches main content width -->
        <div class="lg:w-[728px] lg:flex-shrink-0">
          <a href="/" class="block no-underline hover:no-underline group pl-[5px]">
            <img
              src={logoUp.src}
              alt="TruSchools"
              class="h-[55px] group-hover:hidden"
            />
            <img
              src={logoOver.src}
              alt="TruSchools"
              class="h-[55px] hidden group-hover:block"
            />
          </a>
        </div>

        <!-- Search Box - matches sidebar width -->
        <div class="lg:w-[336px] lg:flex-shrink-0">
          <form action="/search" method="GET" class="flex gap-2">
            <input
              type="text"
              name="q"
              placeholder="Search by school, city or zip"
              class="input flex-1 text-sm"
            />
            <button type="submit" class="btn-green text-sm px-5">
              Search
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- Navigation Menu - Blue Bar -->
    <div class="container">
      <nav class="bg-brand-blue w-full lg:w-[1084px] rounded-box">
        <div class="flex items-center justify-between">
          <!-- Main Navigation (Left) -->
          <ul class="hidden md:flex items-center m-0 p-0 list-none">
            {mainNav.map((item, index) => (
              <li class={`${index > 0 ? 'border-l border-[#3fa9f5]' : ''} ${item.label === 'Vocational Schools' ? 'relative group' : ''}`}>
                {item.label === 'Vocational Schools' ? (
                  <>
                    <a href={item.href} class="flex items-center gap-1 px-5 py-3 text-white font-semibold no-underline hover:bg-[#0a6fc2] hover:no-underline transition-colors">
                      {item.label}
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                      </svg>
                    </a>
                    <div class="absolute left-0 top-full hidden group-hover:block bg-white shadow-lg rounded-b min-w-[200px] z-50">
                      {vocationalDropdown.map((subItem) => (
                        <a href={subItem.href} class="block px-4 py-2 text-gray-700 hover:bg-gray-100 no-underline">
                          {subItem.label}
                        </a>
                      ))}
                    </div>
                  </>
                ) : (
                  <a href={item.href} class={`block px-5 py-3 text-white font-semibold no-underline hover:bg-[#0a6fc2] hover:no-underline transition-colors ${index === 0 ? 'rounded-tl-box rounded-bl-box' : ''}`}>
                    {item.label}
                  </a>
                )}
              </li>
            ))}
          </ul>

          <!-- Mobile menu button - full width tap target -->
          <button type="button" class="md:hidden flex-1 flex items-center p-3 text-white" aria-label="Open menu" id="mobile-menu-btn">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>

          <!-- Right Navigation -->
          <div class="hidden md:flex items-center">
            <!-- Resources Dropdown -->
            <div class="relative group">
              <button class="flex items-center gap-1 px-4 py-3 text-white hover:bg-[#0a6fc2] transition-colors">
                Resources
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
              </button>
              <div class="absolute right-0 top-full hidden group-hover:block bg-white shadow-lg rounded-b min-w-[180px] z-50">
                {resourcesDropdown.map((item) => (
                  <a href={item.href} class="block px-4 py-2 text-gray-700 hover:bg-gray-100 no-underline">
                    {item.label}
                  </a>
                ))}
              </div>
            </div>
            <!-- Schools Dropdown -->
            <div class="relative group">
              <button class="flex items-center gap-1 px-4 py-3 text-white hover:bg-[#0a6fc2] transition-colors">
                Schools
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
              </button>
              <div class="absolute right-0 top-full hidden group-hover:block bg-white shadow-lg rounded-b min-w-[180px] z-50">
                <a href="/preschools" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 no-underline">Preschools</a>
                <a href="/kindergartens" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 no-underline">Kindergartens</a>
                <a href="/elementary-schools" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 no-underline">Elementary Schools</a>
                <a href="/middle-schools" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 no-underline">Middle Schools</a>
                <a href="/high-schools" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 no-underline">High Schools</a>
              </div>
            </div>
            <!-- Login Button -->
            <a href="/login" class="ml-2 mr-3 px-4 py-1.5 bg-white text-brand-green-text text-sm font-medium no-underline hover:bg-brand-green hover:text-white hover:no-underline rounded transition-colors">
              Login
            </a>
          </div>
        </div>

        <!-- Mobile Navigation -->
        <div class="md:hidden hidden py-4 px-5 border-t border-[#3fa9f5]" id="mobile-menu">
          <div class="flex flex-col">
            {mainNav.map((item) => (
              <a href={item.href} class="py-2 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">
                {item.label}
              </a>
            ))}
            <span class="py-2 text-white/70 text-sm border-b border-[#3fa9f5]">Resources</span>
            {resourcesDropdown.map((item) => (
              <a href={item.href} class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">
                {item.label}
              </a>
            ))}
            <span class="py-2 text-white/70 text-sm border-b border-[#3fa9f5]">K-12 Schools</span>
            <a href="/preschools" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">Preschools</a>
            <a href="/kindergartens" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">Kindergartens</a>
            <a href="/elementary-schools" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">Elementary Schools</a>
            <a href="/middle-schools" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">Middle Schools</a>
            <a href="/high-schools" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">High Schools</a>
            <a href="/login" class="py-2 text-white no-underline hover:no-underline">Login</a>
          </div>
        </div>
      </nav>
    </div>
  </header>

  <!-- Main content -->
  <main id="main-content" class="flex-grow">
    <slot />
  </main>

  <!-- Footer -->
  <footer class="bg-brand-blue text-white mt-auto">
    <div class="container py-8">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <!-- About -->
        <div class="md:col-span-2">
          <a href="/" class="block no-underline hover:no-underline group mb-4">
            <img
              src={logoWhiteUp.src}
              alt="TruSchools"
              class="h-[45px] group-hover:hidden"
            />
            <img
              src={logoWhiteOver.src}
              alt="TruSchools"
              class="h-[45px] hidden group-hover:block"
            />
          </a>
          <p class="text-white text-sm mb-0">
            Your comprehensive guide to finding and comparing schools across the United States.
            From preschool to college, we help families make informed education decisions.
          </p>
        </div>

        <!-- Browse Schools -->
        <div>
          <h4 class="text-white mb-4">Browse Schools</h4>
          <ul class="list-none m-0 p-0 space-y-2 text-sm">
            <li><a href="/preschools" class="text-white hover:underline">Preschools</a></li>
            <li><a href="/kindergartens" class="text-white hover:underline">Kindergartens</a></li>
            <li><a href="/elementary-schools" class="text-white hover:underline">Elementary Schools</a></li>
            <li><a href="/middle-schools" class="text-white hover:underline">Middle Schools</a></li>
            <li><a href="/high-schools" class="text-white hover:underline">High Schools</a></li>
            <li><a href="/colleges" class="text-white hover:underline">Colleges & Universities</a></li>
          </ul>
        </div>

        <!-- Company -->
        <div>
          <h4 class="text-white mb-4">Company</h4>
          <ul class="list-none m-0 p-0 space-y-2 text-sm">
            <li><a href="/about" class="text-white hover:underline">About Us</a></li>
            <li><a href="/privacy-policy" class="text-white hover:underline">Privacy Policy</a></li>
            <li><a href="/terms-of-use" class="text-white hover:underline">Terms of Use</a></li>
            <li><a href="/sitemap" class="text-white hover:underline">Sitemap</a></li>
          </ul>
        </div>
      </div>

      <div class="border-t border-white/30 mt-8 pt-6 text-sm text-white">
        <p class="mb-0">&copy; 2011-{currentYear} TruSchools. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Mobile menu script -->
  <script>
    const menuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');

    menuBtn?.addEventListener('click', () => {
      mobileMenu?.classList.toggle('hidden');
    });
  </script>
</body>
</html>
