---
import '@/styles/global.css';
import logoUp from '@/images/logo-truschools-up.png';
import logoOver from '@/images/logo-truschools-over.png';
import logoWhiteUp from '@/images/logo-truschools-white-up.png';
import logoWhiteOver from '@/images/logo-truschools-white-over.png';

interface Props {
  title: string;
  description?: string;
  ogImage?: string;
  noIndex?: boolean;
}

const {
  title,
  description = "TruSchools provides comprehensive information on every college, university and K-12 school in the United States.",
  ogImage = "/og-image.svg",
  noIndex = false
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const fullOgImage = new URL(ogImage, Astro.site);
const currentYear = new Date().getFullYear();

// Navigation items matching original site structure
const mainNav = [
  { label: 'K-12 Schools', href: '/schools', hasDropdown: true },
  { label: 'Colleges & Universities', href: '/colleges-universities' },
  { label: 'Vocational Schools', href: '/vocational-schools' },
];

// K-12 schools dropdown items
const k12Dropdown = [
  { label: 'All K-12 Schools', href: '/schools' },
  { label: 'Preschools', href: '/preschools' },
  { label: 'Kindergartens', href: '/kindergartens' },
  { label: 'Elementary Schools', href: '/elementary-schools' },
  { label: 'Middle Schools', href: '/middle-schools' },
  { label: 'High Schools', href: '/high-schools' },
  { label: 'Charter Schools', href: '/charter-schools' },
  { label: 'Magnet Schools', href: '/magnet-schools' },
  { label: 'Private Schools', href: '/private-schools' },
];

// Vocational schools dropdown items
const vocationalDropdown = [
  { label: 'All Vocational Schools', href: '/vocational-schools' },
  { label: 'Beauty Schools', href: '/beauty-schools' },
  { label: 'Trade Schools', href: '/trade-schools' },
  { label: 'Healthcare Schools', href: '/healthcare-schools' },
  { label: 'Technology Schools', href: '/technology-schools' },
  { label: 'Culinary Schools', href: '/culinary-schools' },
];

// Right nav items (no dropdown)
const rightNav = [
  { label: 'Free Classes', href: '/classes' },
  { label: 'Financial Aid', href: '/financial-aid' },
];
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content={description} />
  {noIndex && <meta name="robots" content="noindex, nofollow" />}
  <title>{title} | TruSchools</title>

  <!-- Canonical -->
  <link rel="canonical" href={canonicalURL} />

  <!-- Open Graph -->
  <meta property="og:title" content={`${title} | TruSchools`} />
  <meta property="og:description" content={description} />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="TruSchools" />
  <meta property="og:url" content={canonicalURL} />
  <meta property="og:image" content={fullOgImage} />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content={`${title} | TruSchools`} />
  <meta name="twitter:description" content={description} />
  <meta name="twitter:image" content={fullOgImage} />

  <!-- Preconnect to improve asset loading -->
  <link rel="preconnect" href="/" crossorigin>

  <!-- Critical inline CSS to prevent FOUC (Flash of Unstyled Content) -->
  <style>
    /* Critical reset and layout styles - prevents unstyled content flash */
    *, *::before, *::after { box-sizing: border-box; }
    html { -webkit-font-smoothing: antialiased; }
    body { margin: 0; font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; font-size: 15px; line-height: 1.2; min-height: 100vh; display: flex; flex-direction: column; }
    .container { max-width: 1200px; margin-left: auto; margin-right: auto; padding-left: 1.25rem; padding-right: 1.25rem; }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border-width: 0; }
    .hidden { display: none; }
    /* Header critical styles */
    header { background: white; }
    nav { background: #0d83dd; border-radius: 5px; }
    .bg-brand-blue { background-color: #0d83dd; }
    .text-white { color: white; }
    .flex { display: flex; }
    .flex-col { flex-direction: column; }
    .items-center { align-items: center; }
    .justify-between { justify-content: space-between; }
    .gap-2 { gap: 0.5rem; }
    .gap-4 { gap: 1rem; }
    .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
    .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
    .px-5 { padding-left: 1.25rem; padding-right: 1.25rem; }
    .font-semibold { font-weight: 600; }
    .no-underline { text-decoration: none; }
    a { color: #0d83dd; text-decoration: none; }
    /* Hide hover logos by default */
    [class*="group-hover:block"] { display: none; }
    [class*="group-hover:hidden"] { display: block; }
    /* List reset */
    ul { list-style: none; margin: 0; padding: 0; }
    /* Logo sizing */
    img[class*="h-[55px]"] { height: 55px; }
    /* Input styling */
    input { font-family: inherit; font-size: inherit; padding: 0.25rem; border: 1px solid #d1d5db; border-radius: 0.25rem; }
    button { font-family: inherit; cursor: pointer; }
    .btn-green { background: #70b52c; color: white; border: 1px solid #5a9023; padding: 0.625rem 1rem; border-radius: 0.25rem; }
    /* Footer */
    footer { background: #0d83dd; color: white; margin-top: auto; }
    footer li { display: block; margin-bottom: 0.375rem; }
    footer li a { color: rgba(255,255,255,0.8); }
    /* Responsive - hide on mobile */
    @media (max-width: 1023px) { [class*="lg:flex"] { display: none !important; } [class*="lg:hidden"] { display: flex !important; } }
    @media (min-width: 1024px) { [class*="lg:flex"] { display: flex !important; } [class*="lg:hidden"] { display: none !important; } [class*="lg:flex-row"] { flex-direction: row; } [class*="lg:items-end"] { align-items: flex-end; } [class*="lg:justify-between"] { justify-content: space-between; } }
  </style>

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico?v=2" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=2" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?v=2" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <meta name="theme-color" content="#0d83dd" />
</head>
<body class="min-h-screen flex flex-col">
  <!-- Skip to content link -->
  <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-brand-blue text-white px-4 py-2 rounded z-50">
    Skip to content
  </a>

  <!-- Header with Logo and Search -->
  <header class="bg-white">
    <div class="container py-4">
      <div class="flex flex-col lg:flex-row lg:items-end lg:justify-between gap-4">
        <!-- Logo -->
        <div class="flex-shrink-0">
          <a href="/" class="block no-underline hover:no-underline group pl-[5px]">
            <img
              src={logoUp.src}
              alt="TruSchools"
              class="h-[55px] group-hover:hidden"
            />
            <img
              src={logoOver.src}
              alt="TruSchools"
              class="h-[55px] hidden group-hover:block"
            />
          </a>
        </div>

        <!-- Search Box -->
        <div class="w-full lg:w-auto lg:max-w-[336px] flex-shrink-0">
          <form action="/search" method="GET" class="flex gap-2">
            <input
              type="text"
              name="q"
              placeholder="Search by school, city or zip"
              class="input flex-1 text-sm min-w-[200px]"
            />
            <button type="submit" class="btn-green text-sm px-5 whitespace-nowrap">
              Search
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- Navigation Menu - Blue Bar -->
    <div class="container">
      <nav class="bg-brand-blue w-full rounded-box">
        <div class="flex items-center justify-between">
          <!-- Main Navigation (Left) -->
          <ul class="hidden lg:flex items-center m-0 p-0 list-none">
            {mainNav.map((item, index) => (
              <li class={`${index > 0 ? 'border-l border-[#3fa9f5]' : ''} ${item.label === 'Vocational Schools' || item.label === 'K-12 Schools' ? 'relative group' : ''}`}>
                {item.label === 'Vocational Schools' ? (
                  <>
                    <a href={item.href} class="flex items-center gap-1 px-5 py-3 text-white font-semibold no-underline hover:bg-[#0a6fc2] hover:no-underline transition-colors">
                      {item.label}
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                      </svg>
                    </a>
                    <div class="absolute left-0 top-full hidden group-hover:block bg-white shadow-lg rounded-b min-w-[200px] z-50">
                      {vocationalDropdown.map((subItem) => (
                        <a href={subItem.href} class="block px-4 py-2 text-gray-700 hover:bg-gray-100 no-underline">
                          {subItem.label}
                        </a>
                      ))}
                    </div>
                  </>
                ) : item.label === 'K-12 Schools' ? (
                  <>
                    <a href={item.href} class="flex items-center gap-1 px-5 py-3 text-white font-semibold no-underline hover:bg-[#0a6fc2] hover:no-underline transition-colors rounded-tl-box rounded-bl-box">
                      {item.label}
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                      </svg>
                    </a>
                    <div class="absolute left-0 top-full hidden group-hover:block bg-white shadow-lg rounded-b min-w-[200px] z-50">
                      {k12Dropdown.map((subItem) => (
                        <a href={subItem.href} class="block px-4 py-2 text-gray-700 hover:bg-gray-100 no-underline">
                          {subItem.label}
                        </a>
                      ))}
                    </div>
                  </>
                ) : (
                  <a href={item.href} class={`block px-5 py-3 text-white font-semibold no-underline hover:bg-[#0a6fc2] hover:no-underline transition-colors ${index === 0 ? 'rounded-tl-box rounded-bl-box' : ''}`}>
                    {item.label}
                  </a>
                )}
              </li>
            ))}
          </ul>

          <!-- Mobile menu button - full width tap target -->
          <button type="button" class="lg:hidden flex-1 flex items-center p-3 text-white" aria-label="Open menu" id="mobile-menu-btn">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>

          <!-- Right Navigation -->
          <div class="hidden lg:flex items-center">
            {rightNav.map((item) => (
              <a href={item.href} class="px-4 py-3 text-white font-semibold no-underline hover:bg-[#0a6fc2] hover:no-underline transition-colors">
                {item.label}
              </a>
            ))}
            <!-- Login Button -->
            <a href="/login" class="ml-2 mr-3 px-4 py-1.5 bg-white text-brand-green-text text-sm font-medium no-underline hover:bg-brand-green hover:text-white hover:no-underline rounded transition-colors">
              Login
            </a>
          </div>
        </div>

        <!-- Mobile Navigation -->
        <div class="lg:hidden hidden py-4 px-5 border-t border-[#3fa9f5]" id="mobile-menu">
          <div class="flex flex-col">
            {mainNav.map((item) => (
              <a href={item.href} class="py-2 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">
                {item.label}
              </a>
            ))}
            {rightNav.map((item) => (
              <a href={item.href} class="py-2 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">
                {item.label}
              </a>
            ))}
            <span class="py-2 text-white/70 text-sm border-b border-[#3fa9f5]">K-12 Schools</span>
            <a href="/preschools" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">Preschools</a>
            <a href="/kindergartens" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">Kindergartens</a>
            <a href="/elementary-schools" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">Elementary Schools</a>
            <a href="/middle-schools" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">Middle Schools</a>
            <a href="/high-schools" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">High Schools</a>
            <a href="/charter-schools" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">Charter Schools</a>
            <a href="/magnet-schools" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">Magnet Schools</a>
            <a href="/private-schools" class="py-2 pl-4 text-white no-underline hover:no-underline border-b border-[#3fa9f5]">Private Schools</a>
            <a href="/login" class="py-2 text-white no-underline hover:no-underline">Login</a>
          </div>
        </div>
      </nav>
    </div>
  </header>

  <!-- Main content -->
  <main id="main-content" class="flex-grow">
    <slot />
  </main>

  <!-- Footer -->
  <footer class="bg-brand-blue text-white mt-auto">
    <div class="container py-8">
      <div class="grid grid-cols-2 md:grid-cols-6 gap-6">
        <!-- About -->
        <div class="col-span-2">
          <a href="/" class="block no-underline hover:no-underline group mb-4">
            <img
              src={logoWhiteUp.src}
              alt="TruSchools"
              class="h-[45px] group-hover:hidden"
            />
            <img
              src={logoWhiteOver.src}
              alt="TruSchools"
              class="h-[45px] hidden group-hover:block"
            />
          </a>
          <p class="text-white text-sm mb-0">
            Your comprehensive guide to finding and comparing schools across the United States.
            From preschool to college, we help families make informed education decisions.
          </p>
        </div>

        <!-- K-12 Schools -->
        <div>
          <h4 class="text-white mb-4 text-sm font-bold">K-12 Schools</h4>
          <ul class="list-none m-0 p-0 space-y-1.5 text-sm">
            <li><a href="/preschools" class="text-white/80 hover:text-white hover:underline">Preschools</a></li>
            <li><a href="/kindergartens" class="text-white/80 hover:text-white hover:underline">Kindergartens</a></li>
            <li><a href="/elementary-schools" class="text-white/80 hover:text-white hover:underline">Elementary Schools</a></li>
            <li><a href="/middle-schools" class="text-white/80 hover:text-white hover:underline">Middle Schools</a></li>
            <li><a href="/high-schools" class="text-white/80 hover:text-white hover:underline">High Schools</a></li>
            <li><a href="/charter-schools" class="text-white/80 hover:text-white hover:underline">Charter Schools</a></li>
            <li><a href="/magnet-schools" class="text-white/80 hover:text-white hover:underline">Magnet Schools</a></li>
            <li><a href="/private-schools" class="text-white/80 hover:text-white hover:underline">Private Schools</a></li>
          </ul>
        </div>

        <!-- Higher Education -->
        <div>
          <h4 class="text-white mb-4 text-sm font-bold">Higher Education</h4>
          <ul class="list-none m-0 p-0 space-y-1.5 text-sm">
            <li><a href="/colleges-universities" class="text-white/80 hover:text-white hover:underline">Colleges & Universities</a></li>
          </ul>
          <h4 class="text-white mb-4 mt-6 text-sm font-bold">Vocational Schools</h4>
          <ul class="list-none m-0 p-0 space-y-1.5 text-sm">
            <li><a href="/vocational-schools" class="text-white/80 hover:text-white hover:underline">All Vocational Schools</a></li>
            <li><a href="/beauty-schools" class="text-white/80 hover:text-white hover:underline">Beauty Schools</a></li>
            <li><a href="/trade-schools" class="text-white/80 hover:text-white hover:underline">Trade Schools</a></li>
            <li><a href="/healthcare-schools" class="text-white/80 hover:text-white hover:underline">Healthcare Schools</a></li>
            <li><a href="/technology-schools" class="text-white/80 hover:text-white hover:underline">Technology Schools</a></li>
            <li><a href="/culinary-schools" class="text-white/80 hover:text-white hover:underline">Culinary Schools</a></li>
          </ul>
        </div>

        <!-- Resources -->
        <div>
          <h4 class="text-white mb-4 text-sm font-bold">Resources</h4>
          <ul class="list-none m-0 p-0 space-y-1.5 text-sm">
            <li><a href="/education-articles" class="text-white/80 hover:text-white hover:underline">Education Articles</a></li>
            <li><a href="/classes" class="text-white/80 hover:text-white hover:underline">Free Classes</a></li>
            <li><a href="/financial-aid" class="text-white/80 hover:text-white hover:underline">Financial Aid</a></li>
            <li><a href="/financial-aid/fafsa/application-guide" class="text-white/80 hover:text-white hover:underline">FAFSA Guide</a></li>
            <li><a href="/financial-aid/grants" class="text-white/80 hover:text-white hover:underline">Grants</a></li>
            <li><a href="/financial-aid/scholarships" class="text-white/80 hover:text-white hover:underline">Scholarships</a></li>
            <li><a href="/search" class="text-white/80 hover:text-white hover:underline">School Search</a></li>
          </ul>
        </div>

        <!-- Company -->
        <div>
          <h4 class="text-white mb-4 text-sm font-bold">Company</h4>
          <ul class="list-none m-0 p-0 space-y-1.5 text-sm">
            <li><a href="/about" class="text-white/80 hover:text-white hover:underline">About Us</a></li>
            <li><a href="/privacy-policy" class="text-white/80 hover:text-white hover:underline">Privacy Policy</a></li>
            <li><a href="/terms-of-use" class="text-white/80 hover:text-white hover:underline">Terms of Use</a></li>
            <li><a href="/sitemap" class="text-white/80 hover:text-white hover:underline">Sitemap</a></li>
          </ul>
        </div>
      </div>

      <div class="border-t border-white/30 mt-8 pt-6 text-sm text-white">
        <p class="mb-0">&copy; 2011-{currentYear} TruSchools. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Mobile menu script -->
  <script>
    const menuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');

    menuBtn?.addEventListener('click', () => {
      mobileMenu?.classList.toggle('hidden');
    });
  </script>
</body>
</html>
